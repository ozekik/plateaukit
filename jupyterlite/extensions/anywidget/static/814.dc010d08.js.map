{"version":3,"file":"814.dc010d08.js","sources":["webpack://@anywidget/monorepo/./packages/anywidget/src/plugin.js","webpack://@anywidget/monorepo/./packages/anywidget/src/widget.js?4f7a"],"sourcesContent":["import * as base from \"@jupyter-widgets/base\";\nimport create from \"./widget.js\";\n\n/**\n * @typedef JupyterLabRegistry\n * @property {(widget: { name: string, version: string, exports: any }) => void} registerWidget\n */\n\nexport default {\n\tid: \"anywidget:plugin\",\n\trequires: [base.IJupyterWidgetRegistry],\n\tactivate: (\n\t\t/** @type {unknown} */ _app,\n\t\t/** @type {JupyterLabRegistry} */ registry,\n\t) => {\n\t\tlet exports = create(base);\n\t\tregistry.registerWidget({\n\t\t\tname: \"anywidget\",\n\t\t\t// @ts-expect-error Added by bundler\n\t\t\tversion: globalThis.VERSION,\n\t\t\texports,\n\t\t});\n\t},\n\tautoStart: true,\n};\n","import * as uuid from \"@lukeed/uuid\";\nimport * as solid from \"solid-js\";\n\n/**\n * @typedef AnyWidget\n * @prop initialize {import(\"@anywidget/types\").Initialize}\n * @prop render {import(\"@anywidget/types\").Render}\n */\n\n/**\n *  @typedef AnyWidgetModule\n *  @prop render {import(\"@anywidget/types\").Render=}\n *  @prop default {AnyWidget | (() => AnyWidget | Promise<AnyWidget>)=}\n */\n\n/**\n * @param {any} condition\n * @param {string} message\n * @returns {asserts condition}\n */\nfunction assert(condition, message) {\n\tif (!condition) throw new Error(message);\n}\n\n/**\n * @param {string} str\n * @returns {str is \"https://${string}\" | \"http://${string}\"}\n */\nfunction is_href(str) {\n\treturn str.startsWith(\"http://\") || str.startsWith(\"https://\");\n}\n\n/**\n * @param {string} href\n * @param {string} anywidget_id\n * @returns {Promise<void>}\n */\nasync function load_css_href(href, anywidget_id) {\n\t/** @type {HTMLLinkElement | null} */\n\tlet prev = document.querySelector(`link[id='${anywidget_id}']`);\n\n\t// Adapted from https://github.com/vitejs/vite/blob/d59e1acc2efc0307488364e9f2fad528ec57f204/packages/vite/src/client/client.ts#L185-L201\n\t// Swaps out old styles with new, but avoids flash of unstyled content.\n\t// No need to await the load since we already have styles applied.\n\tif (prev) {\n\t\tlet newLink = /** @type {HTMLLinkElement} */ (prev.cloneNode());\n\t\tnewLink.href = href;\n\t\tnewLink.addEventListener(\"load\", () => prev?.remove());\n\t\tnewLink.addEventListener(\"error\", () => prev?.remove());\n\t\tprev.after(newLink);\n\t\treturn;\n\t}\n\n\treturn new Promise((resolve) => {\n\t\tlet link = Object.assign(document.createElement(\"link\"), {\n\t\t\trel: \"stylesheet\",\n\t\t\thref,\n\t\t\tonload: resolve,\n\t\t});\n\t\tdocument.head.appendChild(link);\n\t});\n}\n\n/**\n * @param {string} css_text\n * @param {string} anywidget_id\n * @returns {void}\n */\nfunction load_css_text(css_text, anywidget_id) {\n\t/** @type {HTMLStyleElement | null} */\n\tlet prev = document.querySelector(`style[id='${anywidget_id}']`);\n\tif (prev) {\n\t\t// replace instead of creating a new DOM node\n\t\tprev.textContent = css_text;\n\t\treturn;\n\t}\n\tlet style = Object.assign(document.createElement(\"style\"), {\n\t\tid: anywidget_id,\n\t\ttype: \"text/css\",\n\t});\n\tstyle.appendChild(document.createTextNode(css_text));\n\tdocument.head.appendChild(style);\n}\n\n/**\n * @param {string | undefined} css\n * @param {string} anywidget_id\n * @returns {Promise<void>}\n */\nasync function load_css(css, anywidget_id) {\n\tif (!css || !anywidget_id) return;\n\tif (is_href(css)) return load_css_href(css, anywidget_id);\n\treturn load_css_text(css, anywidget_id);\n}\n\n/**\n * @param {string} esm\n * @returns {Promise<{ mod: AnyWidgetModule, url: string }>}\n */\nasync function load_esm(esm) {\n\tif (is_href(esm)) {\n\t\treturn {\n\t\t\tmod: await import(/* webpackIgnore: true */ esm),\n\t\t\turl: esm,\n\t\t};\n\t}\n\tlet url = URL.createObjectURL(new Blob([esm], { type: \"text/javascript\" }));\n\tlet mod = await import(/* webpackIgnore: true */ url);\n\tURL.revokeObjectURL(url);\n\treturn { mod, url };\n}\n\nfunction warn_render_deprecation() {\n\tconsole.warn(`\\\n[anywidget] Deprecation Warning. Direct export of a 'render' will likely be deprecated in the future. To migrate ...\n\nRemove the 'export' keyword from 'render'\n-----------------------------------------\n\nexport function render({ model, el }) { ... }\n^^^^^^\n\nCreate a default export that returns an object with 'render'\n------------------------------------------------------------\n\nfunction render({ model, el }) { ... }\n         ^^^^^^\nexport default { render }\n                 ^^^^^^\n\nTo learn more, please see: https://github.com/manzt/anywidget/pull/395\n`);\n}\n\n/**\n * @param {string} esm\n * @returns {Promise<AnyWidget & { url: string }>}\n */\nasync function load_widget(esm) {\n\tlet { mod, url } = await load_esm(esm);\n\tif (mod.render) {\n\t\twarn_render_deprecation();\n\t\treturn {\n\t\t\turl,\n\t\t\tasync initialize() {},\n\t\t\trender: mod.render,\n\t\t};\n\t}\n\tassert(\n\t\tmod.default,\n\t\t`[anywidget] module must export a default function or object.`,\n\t);\n\tlet widget = typeof mod.default === \"function\"\n\t\t? await mod.default()\n\t\t: mod.default;\n\treturn { url, ...widget };\n}\n\n/**\n * This is a trick so that we can cleanup event listeners added\n * by the user-defined function.\n */\nlet INITIALIZE_MARKER = Symbol(\"anywidget.initialize\");\n\n/**\n * @param {import(\"@jupyter-widgets/base\").DOMWidgetModel} model\n * @param {unknown} context\n * @return {import(\"@anywidget/types\").AnyModel}\n *\n * Prunes the view down to the minimum context necessary.\n *\n * Calls to `model.get` and `model.set` automatically add the\n * `context`, so we can gracefully unsubscribe from events\n * added by user-defined hooks.\n */\nfunction model_proxy(model, context) {\n\treturn {\n\t\tget: model.get.bind(model),\n\t\tset: model.set.bind(model),\n\t\tsave_changes: model.save_changes.bind(model),\n\t\tsend: model.send.bind(model),\n\t\t// @ts-expect-error\n\t\ton(name, callback) {\n\t\t\tmodel.on(name, callback, context);\n\t\t},\n\t\toff(name, callback) {\n\t\t\tmodel.off(name, callback, context);\n\t\t},\n\t\twidget_manager: model.widget_manager,\n\t};\n}\n\n/**\n * @param {void | (() => import('vitest').Awaitable<void>)} fn\n * @param {string} kind\n */\nasync function safe_cleanup(fn, kind) {\n\treturn Promise.resolve()\n\t\t.then(() => fn?.())\n\t\t.catch((e) => console.warn(`[anywidget] error cleaning up ${kind}.`, e));\n}\n\n/**\n * @template T\n * @typedef {{ data: T, state: \"ok\" } | { error: any, state: \"error\" }} Result\n */\n\n/** @type {<T>(data: T) => Result<T>} */\nfunction ok(data) {\n\treturn { data, state: \"ok\" };\n}\n\n/** @type {(e: any) => Result<any>} */\nfunction error(e) {\n\treturn { error: e, state: \"error\" };\n}\n\n/**\n * Cleans up the stack trace at anywidget boundary.\n * You can fully inspect the entire stack trace in the console interactively,\n * but the initial error message is cleaned up to be more user-friendly.\n *\n * @param {unknown} source\n * @returns {never}\n */\nfunction throw_anywidget_error(source) {\n\tif (!(source instanceof Error)) {\n\t\t// Don't know what to do with this.\n\t\tthrow source;\n\t}\n\tlet lines = source.stack?.split(\"\\n\") ?? [];\n\tlet anywidget_index = lines.findIndex((line) => line.includes(\"anywidget\"));\n\tlet clean_stack = anywidget_index === -1\n\t\t? lines\n\t\t: lines.slice(0, anywidget_index + 1);\n\tsource.stack = clean_stack.join(\"\\n\");\n\tconsole.error(source);\n\tthrow source;\n}\n\n/**\n * @typedef InvokeOptions\n * @prop {DataView[]} [buffers]\n * @prop {AbortSignal} [signal]\n */\n\n/**\n * @template T\n * @param {import(\"@anywidget/types\").AnyModel} model\n * @param {string} name\n * @param {any} [msg]\n * @param {InvokeOptions} [options]\n * @return {Promise<[T, DataView[]]>}\n */\nexport function invoke(\n\tmodel,\n\tname,\n\tmsg,\n\toptions = {},\n) {\n\t// crypto.randomUUID() is not available in non-secure contexts (i.e., http://)\n\t// so we use simple (non-secure) polyfill.\n\tlet id = uuid.v4();\n\tlet signal = options.signal ?? AbortSignal.timeout(3000);\n\n\treturn new Promise((resolve, reject) => {\n\t\tif (signal.aborted) {\n\t\t\treject(signal.reason);\n\t\t}\n\t\tsignal.addEventListener(\"abort\", () => {\n\t\t\tmodel.off(\"msg:custom\", handler);\n\t\t\treject(signal.reason);\n\t\t});\n\n\t\t/**\n\t\t * @param {{ id: string, kind: \"anywidget-command-response\", response: T }} msg\n\t\t * @param {DataView[]} buffers\n\t\t */\n\t\tfunction handler(msg, buffers) {\n\t\t\tif (!(msg.id === id)) return;\n\t\t\tresolve([msg.response, buffers]);\n\t\t\tmodel.off(\"msg:custom\", handler);\n\t\t}\n\t\tmodel.on(\"msg:custom\", handler);\n\t\tmodel.send(\n\t\t\t{ id, kind: \"anywidget-command\", name, msg },\n\t\t\tundefined,\n\t\t\toptions.buffers ?? [],\n\t\t);\n\t});\n}\n\nclass Runtime {\n\t/** @type {() => void} */\n\t#disposer = () => {};\n\t/** @type {Set<() => void>} */\n\t#view_disposers = new Set();\n\t/** @type {import('solid-js').Resource<Result<AnyWidget & { url: string }>>} */\n\t// @ts-expect-error - Set synchronously in constructor.\n\t#widget_result;\n\n\t/** @param {import(\"@jupyter-widgets/base\").DOMWidgetModel} model */\n\tconstructor(model) {\n\t\tthis.#disposer = solid.createRoot((dispose) => {\n\t\t\tlet [css, set_css] = solid.createSignal(model.get(\"_css\"));\n\t\t\tmodel.on(\"change:_css\", () => {\n\t\t\t\tlet id = model.get(\"_anywidget_id\");\n\t\t\t\tconsole.debug(`[anywidget] css hot updated: ${id}`);\n\t\t\t\tset_css(model.get(\"_css\"));\n\t\t\t});\n\t\t\tsolid.createEffect(() => {\n\t\t\t\tlet id = model.get(\"_anywidget_id\");\n\t\t\t\tload_css(css(), id);\n\t\t\t});\n\n\t\t\t/** @type {import(\"solid-js\").Signal<string>} */\n\t\t\tlet [esm, setEsm] = solid.createSignal(model.get(\"_esm\"));\n\t\t\tmodel.on(\"change:_esm\", async () => {\n\t\t\t\tlet id = model.get(\"_anywidget_id\");\n\t\t\t\tconsole.debug(`[anywidget] esm hot updated: ${id}`);\n\t\t\t\tsetEsm(model.get(\"_esm\"));\n\t\t\t});\n\t\t\t/** @type {void | (() => import(\"vitest\").Awaitable<void>)} */\n\t\t\tlet cleanup;\n\t\t\tthis.#widget_result = solid.createResource(esm, async (update) => {\n\t\t\t\tawait safe_cleanup(cleanup, \"initialize\");\n\t\t\t\ttry {\n\t\t\t\t\tmodel.off(null, null, INITIALIZE_MARKER);\n\t\t\t\t\tlet widget = await load_widget(update);\n\t\t\t\t\tcleanup = await widget.initialize?.({\n\t\t\t\t\t\tmodel: model_proxy(model, INITIALIZE_MARKER),\n\t\t\t\t\t\texperimental: {\n\t\t\t\t\t\t\t// @ts-expect-error - bind isn't working\n\t\t\t\t\t\t\tinvoke: invoke.bind(null, model),\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\treturn ok(widget);\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn error(e);\n\t\t\t\t}\n\t\t\t})[0];\n\t\t\treturn () => {\n\t\t\t\tcleanup?.();\n\t\t\t\tmodel.off(\"change:_css\");\n\t\t\t\tmodel.off(\"change:_esm\");\n\t\t\t\tdispose();\n\t\t\t};\n\t\t});\n\t}\n\n\t/**\n\t * @param {import(\"@jupyter-widgets/base\").DOMWidgetView} view\n\t * @returns {Promise<() => void>}\n\t */\n\tasync create_view(view) {\n\t\tlet model = view.model;\n\t\tlet disposer = solid.createRoot((dispose) => {\n\t\t\t/** @type {void | (() => import(\"vitest\").Awaitable<void>)} */\n\t\t\tlet cleanup;\n\t\t\tlet resource =\n\t\t\t\tsolid.createResource(this.#widget_result, async (widget_result) => {\n\t\t\t\t\tcleanup?.();\n\t\t\t\t\t// Clear all previous event listeners from this hook.\n\t\t\t\t\tmodel.off(null, null, view);\n\t\t\t\t\tview.$el.empty();\n\t\t\t\t\tif (widget_result.state === \"error\") {\n\t\t\t\t\t\tthrow_anywidget_error(widget_result.error);\n\t\t\t\t\t}\n\t\t\t\t\tlet widget = widget_result.data;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tcleanup = await widget.render?.({\n\t\t\t\t\t\t\tmodel: model_proxy(model, view),\n\t\t\t\t\t\t\tel: view.el,\n\t\t\t\t\t\t\texperimental: {\n\t\t\t\t\t\t\t\t// @ts-expect-error - bind isn't working\n\t\t\t\t\t\t\t\tinvoke: invoke.bind(null, model),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tthrow_anywidget_error(e);\n\t\t\t\t\t}\n\t\t\t\t})[0];\n\t\t\tsolid.createEffect(() => {\n\t\t\t\tif (resource.error) {\n\t\t\t\t\t// TODO: Show error in the view?\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn () => {\n\t\t\t\tdispose();\n\t\t\t\tcleanup?.();\n\t\t\t};\n\t\t});\n\t\t// Have the runtime keep track but allow the view to dispose itself.\n\t\tthis.#view_disposers.add(disposer);\n\t\treturn () => {\n\t\t\tlet deleted = this.#view_disposers.delete(disposer);\n\t\t\tif (deleted) disposer();\n\t\t};\n\t}\n\n\tdispose() {\n\t\tthis.#view_disposers.forEach((dispose) => dispose());\n\t\tthis.#view_disposers.clear();\n\t\tthis.#disposer();\n\t}\n}\n\n// @ts-expect-error - injected by bundler\nlet version = globalThis.VERSION;\n\n/** @param {typeof import(\"@jupyter-widgets/base\")} base */\nexport default function ({ DOMWidgetModel, DOMWidgetView }) {\n\t/** @type {WeakMap<AnyModel, Runtime>} */\n\tlet RUNTIMES = new WeakMap();\n\n\tclass AnyModel extends DOMWidgetModel {\n\t\tstatic model_name = \"AnyModel\";\n\t\tstatic model_module = \"anywidget\";\n\t\tstatic model_module_version = version;\n\n\t\tstatic view_name = \"AnyView\";\n\t\tstatic view_module = \"anywidget\";\n\t\tstatic view_module_version = version;\n\n\t\t/** @param {Parameters<InstanceType<DOMWidgetModel>[\"initialize\"]>} args */\n\t\tinitialize(...args) {\n\t\t\tsuper.initialize(...args);\n\t\t\tlet runtime = new Runtime(this);\n\t\t\tthis.once(\"destroy\", () => {\n\t\t\t\ttry {\n\t\t\t\t\truntime.dispose();\n\t\t\t\t} finally {\n\t\t\t\t\tRUNTIMES.delete(this);\n\t\t\t\t}\n\t\t\t});\n\t\t\tRUNTIMES.set(this, runtime);\n\t\t}\n\n\t\t/**\n\t\t * @param {Record<string, any>} state\n\t\t *\n\t\t * We override to support binary trailets because JSON.parse(JSON.stringify())\n\t\t * does not properly clone binary data (it just returns an empty object).\n\t\t *\n\t\t * https://github.com/jupyter-widgets/ipywidgets/blob/47058a373d2c2b3acf101677b2745e14b76dd74b/packages/base/src/widget.ts#L562-L583\n\t\t */\n\t\tserialize(state) {\n\t\t\tlet serializers =\n\t\t\t\t/** @type {DOMWidgetModel} */ (this.constructor).serializers || {};\n\t\t\tfor (let k of Object.keys(state)) {\n\t\t\t\ttry {\n\t\t\t\t\tlet serialize = serializers[k]?.serialize;\n\t\t\t\t\tif (serialize) {\n\t\t\t\t\t\tstate[k] = serialize(state[k], this);\n\t\t\t\t\t} else if (k === \"layout\" || k === \"style\") {\n\t\t\t\t\t\t// These keys come from ipywidgets, rely on JSON.stringify trick.\n\t\t\t\t\t\tstate[k] = JSON.parse(JSON.stringify(state[k]));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstate[k] = structuredClone(state[k]);\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof state[k]?.toJSON === \"function\") {\n\t\t\t\t\t\tstate[k] = state[k].toJSON();\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(\"Error serializing widget state attribute: \", k);\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn state;\n\t\t}\n\t}\n\n\tclass AnyView extends DOMWidgetView {\n\t\t/** @type {undefined | (() => void)} */\n\t\t#dispose = undefined;\n\t\tasync render() {\n\t\t\tlet runtime = RUNTIMES.get(this.model);\n\t\t\tassert(runtime, \"[anywidget] runtime not found.\");\n\t\t\tassert(!this.#dispose, \"[anywidget] dispose already set.\");\n\t\t\tthis.#dispose = await runtime.create_view(this);\n\t\t}\n\t\tremove() {\n\t\t\tthis.#dispose?.();\n\t\t\tsuper.remove();\n\t\t}\n\t}\n\n\treturn { AnyModel, AnyView };\n}\n"],"names":[],"mappings":"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"}